(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[74],{9961:function(e,t,s){Promise.resolve().then(s.bind(s,2470))},2470:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N}});var a=s(7437),l=s(7138),n=s(2265),r=s(649),o=s(6760),c=s(4608);let i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],d=["Draft","Doc","Posted","Notice","Done"],x={Draft:{dot:"bg-slate-400",badge:"bg-slate-100 text-slate-600",text:"text-slate-600"},Doc:{dot:"bg-amber-400",badge:"bg-amber-100 text-amber-700",text:"text-amber-700"},Posted:{dot:"bg-sky-400",badge:"bg-sky-100 text-sky-700",text:"text-sky-700"},Notice:{dot:"bg-violet-400",badge:"bg-violet-100 text-violet-700",text:"text-violet-700"},Done:{dot:"bg-emerald-400",badge:"bg-emerald-100 text-emerald-700",text:"text-emerald-700"}},u=e=>{let t=e.getFullYear(),s="".concat(e.getMonth()+1).padStart(2,"0"),a="".concat(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(s,"-").concat(a)},m=e=>new Date(e.getFullYear(),e.getMonth(),1),b=e=>new Date(e.getFullYear(),e.getMonth()+1,0),h=(e,t)=>{let s=new Date(e);return s.setDate(s.getDate()+t),s},f=e=>h(e,-e.getDay()),p=e=>h(e,6-e.getDay()),g=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth(),j=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate(),y=(e,t)=>e||t?e&&t?"".concat(e," - ").concat(t):e?"".concat(e," -"):"- ".concat(t):"ไม่ระบุเวลา";function N(){let[e,t]=(0,n.useState)(()=>new Date),[s,N]=(0,n.useState)([]),[v,w]=(0,n.useState)(!0),[k,D]=(0,n.useState)(null),[S,M]=(0,n.useState)(null),[Y,Z]=(0,n.useState)(!1),[_,E]=(0,n.useState)([]),[C,F]=(0,n.useState)(!1),[P,z]=(0,n.useState)(null),O=(0,n.useMemo)(()=>m(e),[e]),T=(0,n.useMemo)(()=>b(e),[e]),A=(0,n.useMemo)(()=>f(O),[O]),L=(0,n.useMemo)(()=>p(T),[T]),U=(0,n.useMemo)(()=>{let e=[],t=A;for(;t<=L;)e.push(t),t=h(t,1);return e},[A,L]),B=(0,n.useMemo)(()=>{let e=new Map;return s.forEach(t=>{e.set(t.date,t)}),e},[s]),W=(0,n.useMemo)(()=>e.toLocaleString("en-US",{month:"long",year:"numeric"}),[e]),$=(0,n.useMemo)(()=>{let e={total:0,done:0,notice:0,posted:0};return s.forEach(t=>{var s,a,l;e.total+=t.total,e.done+=null!==(s=t.byStatus.Done)&&void 0!==s?s:0,e.notice+=null!==(a=t.byStatus.Notice)&&void 0!==a?a:0,e.posted+=null!==(l=t.byStatus.Posted)&&void 0!==l?l:0}),e},[s]);(0,n.useEffect)(()=>{(async()=>{w(!0),D(null);let e=u(A),t=u(L);try{let s=await fetch("/api/jobs/calendar?from=".concat(e,"&to=").concat(t));if(!s.ok)throw Error("โหลดข้อมูลไม่สำเร็จ");let a=await s.json();N(a)}catch(e){D(e instanceof Error?e.message:"โหลดข้อมูลไม่สำเร็จ"),N([])}finally{w(!1)}})()},[A,L]),(0,n.useEffect)(()=>{Y&&S&&(async()=>{F(!0),z(null);let e=u(S);try{let t=await fetch("/api/jobs?date=".concat(e));if(!t.ok)throw Error("โหลดรายการไม่สำเร็จ");let s=await t.json();E(s)}catch(e){z(e instanceof Error?e.message:"โหลดรายการไม่สำเร็จ"),E([])}finally{F(!1)}})()},[Y,S]);let q=e=>{M(e),Z(!0)},G=()=>{Z(!1),E([]),z(null)};return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("header",{className:"space-y-3",children:[(0,a.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:"Schedule"}),(0,a.jsx)("h1",{className:"text-3xl font-semibold tracking-tight text-slate-900",children:"Calendar"}),(0,a.jsx)("p",{className:"text-sm text-slate-600",children:"ภาพรวมปฏิทินงานและการติดตามเอกสารในเดือนนี้"})]}),(0,a.jsx)(c.Zb,{children:(0,a.jsxs)(c.aY,{className:"flex flex-wrap items-center justify-between gap-4 py-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.25em] text-slate-400",children:"Month view"}),(0,a.jsx)("h2",{className:"mt-2 text-2xl font-semibold text-slate-900",children:W})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(o.Z,{type:"button",variant:"secondary",size:"sm",onClick:()=>{t(e=>new Date(e.getFullYear(),e.getMonth()-1,1))},children:"Previous"}),(0,a.jsx)(o.Z,{type:"button",variant:"secondary",size:"sm",onClick:()=>{t(e=>new Date(e.getFullYear(),e.getMonth()+1,1))},children:"Next"})]})]})}),(0,a.jsxs)("section",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:[(0,a.jsx)(c.Zb,{children:(0,a.jsxs)(c.aY,{className:"space-y-2 py-5",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-500",children:"Total outages this month"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-slate-900",children:$.total}),(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"รายการที่ถูกบันทึกไว้ในเดือนนี้"})]})}),(0,a.jsx)(c.Zb,{children:(0,a.jsxs)(c.aY,{className:"space-y-2 py-5",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-500",children:"Posted & notice"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-slate-900",children:$.posted+$.notice}),(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"งานที่มีประกาศหรือโพสต์แล้วในเดือนนี้"})]})}),(0,a.jsx)(c.Zb,{children:(0,a.jsxs)(c.aY,{className:"space-y-2 py-5",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-500",children:"Completed"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-slate-900",children:$.done}),(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"งานที่ปิดสำเร็จแล้ว"})]})})]}),(0,a.jsx)(c.Zb,{children:(0,a.jsxs)(c.aY,{className:"py-6",children:[(0,a.jsx)("div",{className:"grid grid-cols-7 gap-2 text-xs font-semibold uppercase tracking-wide text-slate-400",children:i.map(e=>(0,a.jsx)("div",{className:"px-2",children:e},e))}),(0,a.jsx)("div",{className:"mt-3 grid grid-cols-7 gap-3",children:U.map(t=>{let s=u(t),l=B.get(s),n=g(t,e),o=!!S&&j(t,S);return(0,a.jsxs)("button",{type:"button",onClick:()=>q(t),className:"flex min-h-[120px] flex-col gap-2 rounded-2xl border px-3 py-3 text-left transition hover:border-slate-300 hover:bg-slate-50/60 ".concat(o?"border-slate-400 bg-slate-50":"border-slate-200/70 bg-white"," ").concat(n?"":"text-slate-400"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-semibold",children:t.getDate()}),(null==l?void 0:l.total)?(0,a.jsx)(r.Z,{variant:"neutral",children:l.total}):null]}),v?(0,a.jsx)("div",{className:"mt-2 h-12 rounded-xl bg-slate-100"}):k?(0,a.jsx)("p",{className:"text-xs text-rose-500",children:"โหลดไม่สำเร็จ"}):l?(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:d.map(e=>{let t=l.byStatus[e];return t?(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-2 py-0.5 text-[11px] font-semibold text-slate-600",children:[(0,a.jsx)("span",{className:"h-2 w-2 rounded-full ".concat(x[e].dot)}),e," ",t]},"".concat(s,"-").concat(e)):null})}):(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"ไม่มีงาน"})]},s)})})]})}),Y?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex justify-end",children:[(0,a.jsx)("button",{type:"button",className:"absolute inset-0 bg-slate-900/40",onClick:G,"aria-label":"Close calendar drawer"}),(0,a.jsxs)("div",{className:"relative flex h-full w-full max-w-md flex-col bg-white shadow-2xl",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between border-b border-slate-200 px-6 py-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-400",children:"Daily outages"}),(0,a.jsx)("h2",{className:"mt-2 text-xl font-semibold text-slate-900",children:S?S.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}):""})]}),(0,a.jsx)(o.Z,{type:"button",variant:"ghost",size:"sm",onClick:G,children:"ปิด"})]}),(0,a.jsx)("div",{className:"flex-1 space-y-4 overflow-y-auto px-6 py-5",children:C?(0,a.jsx)("div",{className:"space-y-3",children:Array.from({length:4}).map((e,t)=>(0,a.jsx)("div",{className:"h-20 rounded-2xl border border-slate-200 bg-slate-50"},"skeleton-".concat(t)))}):P?(0,a.jsx)("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-600",children:P}):_.length?(0,a.jsx)("div",{className:"space-y-3",children:_.map(e=>{var t;let s=d.find(t=>t===e.status),n=s?x[s].badge:"bg-slate-100 text-slate-600";return(0,a.jsxs)(l.default,{href:"/job/".concat(e.id),className:"flex flex-col gap-3 rounded-2xl border border-slate-200/70 bg-white px-4 py-4 transition hover:border-slate-300 hover:bg-slate-50",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:y(e.time_start,e.time_end)}),(0,a.jsx)("span",{className:"rounded-full px-3 py-1 text-xs font-semibold ".concat(n),children:e.status})]}),(0,a.jsx)("p",{className:"text-sm text-slate-600",children:null!==(t=e.area_title)&&void 0!==t?t:"ไม่ระบุพื้นที่"})]},e.id)})}):(0,a.jsx)("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-4 py-6 text-center text-sm text-slate-500",children:"ยังไม่มีงานในวันนี้"})})]})]}):null]})}},649:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(7437),l=s(9354);let n={default:"border border-slate-200/80 bg-slate-100/70 text-slate-600",accent:"border border-fuchsia-200/70 bg-fuchsia-50 text-fuchsia-700",success:"border border-emerald-200/80 bg-emerald-50 text-emerald-700",warning:"border border-amber-200/80 bg-amber-50 text-amber-700",danger:"border border-rose-200/80 bg-rose-50 text-rose-700",neutral:"border border-slate-200/70 bg-white text-slate-700"};function r(e){let{variant:t="default",className:s,...r}=e;return(0,a.jsx)("span",{...r,className:(0,l.cn)("inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-semibold",n[t],s)})}},6760:function(e,t,s){"use strict";s.d(t,{$:function(){return o},Z:function(){return c}});var a=s(7437),l=s(9354);let n={primary:"bg-gradient-to-r from-fuchsia-500 via-purple-500 to-pink-500 text-white shadow-[0_16px_30px_rgba(236,72,153,0.25)] hover:brightness-110",secondary:"border border-slate-200/80 bg-white text-slate-700 shadow-sm hover:bg-slate-50",ghost:"text-slate-600 hover:bg-slate-100/80 hover:text-slate-900"},r={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-5 py-2.5 text-sm"};function o(e){let{variant:t="primary",size:s="md",className:a}=e;return(0,l.cn)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-full font-medium transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-fuchsia-300 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-60",n[t],r[s],a)}function c(e){let{className:t,variant:s,size:l,...n}=e;return(0,a.jsx)("button",{...n,className:o({variant:s,size:l,className:t})})}},4608:function(e,t,s){"use strict";s.d(t,{Ol:function(){return r},SZ:function(){return c},Zb:function(){return n},aY:function(){return i},ll:function(){return o}});var a=s(7437),l=s(9354);function n(e){let{className:t,...s}=e;return(0,a.jsx)("div",{...s,className:(0,l.cn)("rounded-2xl border border-slate-200/70 bg-white shadow-sm",t)})}function r(e){let{className:t,...s}=e;return(0,a.jsx)("div",{...s,className:(0,l.cn)("px-5 pt-5",t)})}function o(e){let{className:t,...s}=e;return(0,a.jsx)("h3",{...s,className:(0,l.cn)("text-lg font-semibold tracking-tight text-slate-900",t)})}function c(e){let{className:t,...s}=e;return(0,a.jsx)("p",{...s,className:(0,l.cn)("text-sm text-slate-600",t)})}function i(e){let{className:t,...s}=e;return(0,a.jsx)("div",{...s,className:(0,l.cn)("px-5 pb-5",t)})}},9354:function(e,t,s){"use strict";function a(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter(Boolean).join(" ")}s.d(t,{cn:function(){return a}})}},function(e){e.O(0,[138,971,23,744],function(){return e(e.s=9961)}),_N_E=e.O()}]);