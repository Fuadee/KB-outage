"use strict";(()=>{var e={};e.id=750,e.ids=[750],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9506:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>E,patchFetch:()=>g,requestAsyncStorage:()=>m,routeModule:()=>h,serverHooks:()=>j,staticGenerationAsyncStorage:()=>_});var s={};r.r(s),r.d(s,{POST:()=>l,runtime:()=>p});var o=r(9303),n=r(8716),i=r(670),a=r(7070),u=r(7857);let p="nodejs",c=process.env.SUPABASE_URL??"https://yhkrzepnokhiqbxwhkgz.supabase.co",d=process.env.SUPABASE_SERVICE_ROLE_KEY;async function l(e){try{let t=await e.json(),r=t?.jobId,s=t?.notice_date,o=t?.notice_by?.trim(),n=t?.mymaps_url?.trim();if(!r)return a.NextResponse.json({ok:!1,error:"missing jobId"},{status:400});if(!s||!o||!n)return a.NextResponse.json({ok:!1,error:"missing required fields"},{status:400});if(!/^https?:\/\//i.test(n))return a.NextResponse.json({ok:!1,error:"invalid mymaps_url"},{status:400});let i=function(){if(!c)throw Error("Missing SUPABASE_URL env var.");if(!d)throw Error("Missing SUPABASE_SERVICE_ROLE_KEY env var.");return(0,u.eI)(c,d)}(),p=new Date().toISOString(),{error:l}=await i.from("outage_jobs").update({notice_status:"SCHEDULED",notice_date:s,notice_by:o,mymaps_url:n,notice_scheduled_at:p}).eq("id",r);if(l)throw Error(l.message);return a.NextResponse.json({ok:!0,notice_scheduled_at:p})}catch(e){return console.error("Notice schedule failed",e),a.NextResponse.json({ok:!1,error:"ไม่สามารถบันทึกกำหนดการได้ กรุณาลองใหม่"},{status:500})}}let h=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/jobs/notice-schedule/route",pathname:"/api/jobs/notice-schedule",filename:"route",bundlePath:"app/api/jobs/notice-schedule/route"},resolvedPagePath:"C:\\Users\\506870\\Desktop\\KB-outage\\src\\app\\api\\jobs\\notice-schedule\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:_,serverHooks:j}=h,E="/api/jobs/notice-schedule/route";function g(){return(0,i.patchFetch)({serverHooks:j,staticGenerationAsyncStorage:_})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,564],()=>r(9506));module.exports=s})();