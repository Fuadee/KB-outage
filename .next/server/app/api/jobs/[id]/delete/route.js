"use strict";(()=>{var e={};e.id=304,e.ids=[304],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9240:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>A,requestAsyncStorage:()=>j,routeModule:()=>E,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var s={};r.r(s),r.d(s,{DELETE:()=>x,runtime:()=>d});var o=r(9303),n=r(8716),a=r(670),i=r(7070),u=r(7857),p=r(3240);let d="nodejs",l=process.env.SUPABASE_URL??"https://yhkrzepnokhiqbxwhkgz.supabase.co",c=process.env.SUPABASE_SERVICE_ROLE_KEY;async function x(e,t){try{let{accessToken:e}=(0,p.BK)();if(!e)return i.NextResponse.json({ok:!1,error:"UNAUTHENTICATED"},{status:401});let r=(0,p.lx)(),{data:{user:s},error:o}=await r.auth.getUser(e);if(o||!s)return i.NextResponse.json({ok:!1,error:"UNAUTHENTICATED"},{status:401});let n=t.params.id;if(!n)return i.NextResponse.json({ok:!1,error:"missing job id"},{status:400});let a=function(){if(!l)throw Error("Missing SUPABASE_URL env var.");if(!c)throw Error("Missing SUPABASE_SERVICE_ROLE_KEY env var.");return(0,u.eI)(l,c)}(),{data:d,error:x}=await a.from("outage_jobs").delete().eq("id",n).select("id");if(x)throw x;let E=d?.length??0;if(0===E)return i.NextResponse.json({ok:!1,error:"ไม่พบข้อมูลงานที่ต้องการ",deletedCount:E},{status:404});return i.NextResponse.json({ok:!0,deletedCount:E})}catch(e){return console.error("Delete job failed",e),i.NextResponse.json({ok:!1,error:"ลบไม่สำเร็จ กรุณาลองใหม่"},{status:500})}}let E=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/jobs/[id]/delete/route",pathname:"/api/jobs/[id]/delete",filename:"route",bundlePath:"app/api/jobs/[id]/delete/route"},resolvedPagePath:"C:\\Users\\506870\\Desktop\\KB-outage\\src\\app\\api\\jobs\\[id]\\delete\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:j,staticGenerationAsyncStorage:g,serverHooks:h}=E,m="/api/jobs/[id]/delete/route";function A(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,564,240],()=>r(9240));module.exports=s})();