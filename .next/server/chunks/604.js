exports.id=604,exports.ids=[604],exports.modules={519:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},6215:()=>{},7687:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(326);function a({isOpen:e,title:t,onClose:s,children:a}){return e?(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[r.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:s,role:"presentation"}),(0,r.jsxs)("div",{className:"relative z-10 w-full max-w-lg rounded-xl bg-white p-6 shadow-xl",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[t?r.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:t}):null,r.jsx("button",{type:"button",onClick:s,className:"text-sm text-slate-500 hover:text-slate-700",children:"ปิด"})]}),r.jsx("div",{className:"mt-4",children:a})]})]}):null}},9068:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var r=s(326),a=s(7577),l=s(7687);function n({open:e,onOpenChange:t,job:s,onJobUpdate:n}){let[o,i]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),[p,x]=(0,a.useState)({}),[h,f]=(0,a.useState)(!1),[b,y]=(0,a.useState)(null),g=async()=>{if(!s)return;let e={},r=u.trim();if(o||(e.noticeDate="กรุณาระบุวันที่จะไปดำเนินการแจ้ง"),d.trim()||(e.noticeBy="กรุณาระบุผู้แจ้ง"),r){let t=/^https?:\/\//i.test(r)?r:`https://${r}`;try{let e=new URL(t);if("http:"!==e.protocol&&"https:"!==e.protocol)throw Error("invalid protocol")}catch{e.mymapsUrl="ลิ้งไม่ถูกต้อง"}}else e.mymapsUrl="กรุณาระบุลิ้ง my map";if(Object.keys(e).length>0){x(e);return}f(!0),x({});try{let e=/^https?:\/\//i.test(r)?r:`https://${r}`,a={jobId:s.id,notice_date:o,notice_by:d.trim(),mymaps_url:e},l=await fetch("/api/jobs/notice-schedule",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),i=await l.json().catch(()=>null);if(!l.ok||!i?.ok)throw Error(i?.error??"ไม่สามารถบันทึกกำหนดการได้");let c=i.notice_scheduled_at??new Date().toISOString();n?.(s.id,{notice_status:"SCHEDULED",notice_date:a.notice_date,notice_by:a.notice_by,mymaps_url:a.mymaps_url,notice_scheduled_at:c}),y("กำหนดการแจ้งเรียบร้อยแล้ว"),setTimeout(()=>{t(!1)},800)}catch(e){console.error("Notice schedule failed",e),x({submit:"บันทึกกำหนดการไม่สำเร็จ กรุณาลองใหม่"})}finally{f(!1)}};return r.jsx(l.Z,{isOpen:e,title:"แจ้งหนังสือดับไฟ",onClose:()=>t(!1),children:(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[b?r.jsx("div",{className:"rounded-xl border border-emerald-200 bg-emerald-50 px-3 py-2 text-sm text-emerald-700",children:b}):null,(0,r.jsxs)("label",{className:"flex flex-col gap-2 text-sm font-medium text-slate-700",children:["วันที่จะไปดำเนินการแจ้ง",r.jsx("input",{type:"date",value:o,onChange:e=>i(e.target.value),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm outline-none focus:border-slate-400",required:!0}),p.noticeDate?r.jsx("span",{className:"text-xs text-red-600",children:p.noticeDate}):null]}),(0,r.jsxs)("label",{className:"flex flex-col gap-2 text-sm font-medium text-slate-700",children:["ผู้แจ้ง",r.jsx("input",{type:"text",value:d,onChange:e=>c(e.target.value),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm outline-none focus:border-slate-400",required:!0}),p.noticeBy?r.jsx("span",{className:"text-xs text-red-600",children:p.noticeBy}):null]}),(0,r.jsxs)("label",{className:"flex flex-col gap-2 text-sm font-medium text-slate-700",children:["ลิ้ง my map",r.jsx("input",{type:"url",value:u,onChange:e=>m(e.target.value),placeholder:"https://",className:"rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm outline-none focus:border-slate-400",required:!0}),p.mymapsUrl?r.jsx("span",{className:"text-xs text-red-600",children:p.mymapsUrl}):null]}),p.submit?r.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:p.submit}):null,(0,r.jsxs)("div",{className:"flex flex-wrap justify-end gap-3",children:[r.jsx("button",{type:"button",onClick:()=>t(!1),className:"rounded-xl border border-slate-200 px-4 py-2 text-sm font-medium text-slate-700 shadow-sm transition hover:bg-slate-100",children:"ยกเลิก"}),r.jsx("button",{type:"button",onClick:g,disabled:h,className:"rounded-xl bg-slate-900 px-4 py-2 text-sm font-medium text-white shadow-sm transition hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-70",children:h?"กำลังบันทึก...":"บันทึกกำหนดการ"})]})]})})}},4029:(e,t,s)=>{"use strict";s.d(t,{Z:()=>b});var r=s(326),a=s(7577);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),o=e=>{let t=n(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=(...e)=>e.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim(),d=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:r,className:l="",children:n,iconNode:o,...u},m)=>(0,a.createElement)("svg",{ref:m,...c,width:t,height:t,stroke:e,strokeWidth:r?24*Number(s)/Number(t):s,className:i("lucide",l),...!n&&!d(u)&&{"aria-hidden":"true"},...u},[...o.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(n)?n:[n]])),m=(e,t)=>{let s=(0,a.forwardRef)(({className:s,...r},n)=>(0,a.createElement)(u,{ref:n,iconNode:t,className:i(`lucide-${l(o(e))}`,`lucide-${e}`,s),...r}));return s.displayName=o(e),s},p=m("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),x=m("route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]),h=e=>{let t=e?.trim();if(!t)return null;let s=/^https?:\/\//i.test(t)?t:`https://${t}`;try{let e=new URL(s);if("http:"!==e.protocol&&"https:"!==e.protocol)return null;return e.toString()}catch{return null}},f=e=>{e.stopPropagation()};function b({googleUrl:e,myMapUrl:t,className:s=""}){let a=h(e),l=h(t);if(!a&&!l)return null;let n="h-4 w-4 text-purple-600",o=`flex items-center justify-center gap-2 w-full md:w-auto rounded-2xl md:rounded-xl py-3 md:py-2 px-4 md:px-3 text-sm md:text-xs font-semibold md:font-medium transition-all duration-200 ease-out active:scale-[0.97] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-purple-400 focus-visible:ring-offset-2 relative z-10 select-none
  bg-white
  border border-purple-200/80
  shadow-sm md:shadow-none
  hover:bg-purple-50/60 hover:border-purple-300/80
`,i=!!(a&&l),d=s?` ${s}`:"",c=(e,t,s,a)=>(0,r.jsxs)("a",{href:e,target:"_blank",rel:"noopener noreferrer",onClick:f,onPointerDownCapture:f,className:o,children:[s,r.jsx("span",{className:"bg-gradient-to-r from-purple-700 via-violet-700 to-indigo-700 bg-clip-text text-transparent",children:t})]});return(0,r.jsxs)("div",{className:`${i?"grid grid-cols-2 gap-2 mt-2 md:mt-1 md:justify-items-start":"mt-2 md:mt-1"}${d}`,children:[a?c(a,"Google Map",r.jsx(p,{className:n,"aria-hidden":"true"}),!0):null,l?c(l,"My Map",r.jsx(x,{className:n,"aria-hidden":"true"}),!a):null]})}},8927:(e,t,s)=>{"use strict";s.d(t,{Cq:()=>l,DQ:()=>a,Z6:()=>o,gK:()=>n,uA:()=>i});var r=s(1632);async function a(){return r.O.from("outage_jobs").select("*").order("outage_date",{ascending:!0})}async function l(e){return r.O.from("outage_jobs").insert({outage_date:e.outage_date,equipment_code:e.equipment_code,note:e.note??null})}async function n(e,t){return r.O.from("outage_jobs").update({outage_date:t.outage_date,equipment_code:t.equipment_code,note:t.note??null}).eq("id",e)}async function o(e,t){return r.O.from("outage_jobs").update({nakhon_status:"NOTIFIED",nakhon_notified_date:t.date,nakhon_memo_no:t.memoNo}).eq("id",e)}async function i(e){return r.O.from("outage_jobs").update({nakhon_status:"NOT_REQUIRED",nakhon_notified_date:null,nakhon_memo_no:null}).eq("id",e)}},1632:(e,t,s)=>{"use strict";s.d(t,{O:()=>r});let r=(0,s(9701).e)()},9701:(e,t,s)=>{"use strict";s.d(t,{X:()=>c,e:()=>d});var r=s(5157);let a="https://yhkrzepnokhiqbxwhkgz.supabase.co",l="sb_publishable_CdTtNwP3k39LxhkLkKbS3w_Y3co_tFE",n=null,o=()=>{if(!a||!l)throw Error("Missing Supabase env vars. Set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY.")},i=async(e,t)=>{},d=()=>(o(),n||(n=(0,r.eI)(a,l)),n),c=async e=>{await i(e.access_token,e.refresh_token)}},2029:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l,metadata:()=>a});var r=s(9510);s(5023);let a={title:"Krabi Outage Tracker",description:"Track planned outages in Krabi."};function l({children:e}){return r.jsx("html",{lang:"th",children:r.jsx("body",{children:r.jsx("div",{className:"min-h-screen",children:r.jsx("main",{className:"mx-auto flex w-full max-w-5xl flex-col px-4 py-8",children:e})})})})}},5023:()=>{}};