exports.id=221,exports.ids=[221],exports.modules={519:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},6215:()=>{},7687:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(326);function a({isOpen:e,title:t,onClose:r,children:a}){return e?(0,s.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[s.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm",onClick:r,role:"presentation"}),(0,s.jsxs)("div",{className:"relative z-10 w-full max-w-lg rounded-2xl border border-slate-200/70 bg-white p-6 shadow-xl",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[t?s.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:t}):null,s.jsx("button",{type:"button",onClick:r,className:"text-sm font-medium text-slate-500 hover:text-slate-700",children:"ปิด"})]}),s.jsx("div",{className:"mt-4",children:a})]})]}):null}},9068:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var s=r(326),a=r(7577),n=r(7687),l=r(9837),i=r(9175);function o({open:e,onOpenChange:t,job:r,onJobUpdate:o}){let[c,d]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),[x,h]=(0,a.useState)(""),[p,f]=(0,a.useState)({}),[b,g]=(0,a.useState)(!1),[y,j]=(0,a.useState)(null),v=async()=>{if(!r)return;let e={},s=x.trim();if(c||(e.noticeDate="กรุณาระบุวันที่จะไปดำเนินการแจ้ง"),u.trim()||(e.noticeBy="กรุณาระบุผู้แจ้ง"),s){let t=/^https?:\/\//i.test(s)?s:`https://${s}`;try{let e=new URL(t);if("http:"!==e.protocol&&"https:"!==e.protocol)throw Error("invalid protocol")}catch{e.mymapsUrl="ลิ้งไม่ถูกต้อง"}}else e.mymapsUrl="กรุณาระบุลิ้ง my map";if(Object.keys(e).length>0){f(e);return}g(!0),f({});try{let e=/^https?:\/\//i.test(s)?s:`https://${s}`,a={jobId:r.id,notice_date:c,notice_by:u.trim(),mymaps_url:e},n=await fetch("/api/jobs/notice-schedule",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),l=await n.json().catch(()=>null);if(!n.ok||!l?.ok)throw Error(l?.error??"ไม่สามารถบันทึกกำหนดการได้");let i=l.notice_scheduled_at??new Date().toISOString();o?.(r.id,{notice_status:"SCHEDULED",notice_date:a.notice_date,notice_by:a.notice_by,mymaps_url:a.mymaps_url,notice_scheduled_at:i}),j("กำหนดการแจ้งเรียบร้อยแล้ว"),setTimeout(()=>{t(!1)},800)}catch(e){console.error("Notice schedule failed",e),f({submit:"บันทึกกำหนดการไม่สำเร็จ กรุณาลองใหม่"})}finally{g(!1)}};return s.jsx(n.Z,{isOpen:e,title:"แจ้งหนังสือดับไฟ",onClose:()=>t(!1),children:(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[y?s.jsx("div",{className:"rounded-xl border border-emerald-200 bg-emerald-50 px-3 py-2 text-sm text-emerald-700",children:y}):null,(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-sm font-medium text-slate-700",children:["วันที่จะไปดำเนินการแจ้ง",s.jsx(i.Z,{type:"date",value:c,onChange:e=>d(e.target.value),required:!0}),p.noticeDate?s.jsx("span",{className:"text-xs text-red-600",children:p.noticeDate}):null]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-sm font-medium text-slate-700",children:["ผู้แจ้ง",s.jsx(i.Z,{type:"text",value:u,onChange:e=>m(e.target.value),required:!0}),p.noticeBy?s.jsx("span",{className:"text-xs text-red-600",children:p.noticeBy}):null]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-sm font-medium text-slate-700",children:["ลิ้ง my map",s.jsx(i.Z,{type:"url",value:x,onChange:e=>h(e.target.value),placeholder:"https://",required:!0}),p.mymapsUrl?s.jsx("span",{className:"text-xs text-red-600",children:p.mymapsUrl}):null]}),p.submit?s.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:p.submit}):null,(0,s.jsxs)("div",{className:"flex flex-wrap justify-end gap-3",children:[s.jsx(l.Z,{type:"button",variant:"secondary",onClick:()=>t(!1),children:"ยกเลิก"}),s.jsx(l.Z,{type:"button",onClick:v,disabled:b,children:b?"กำลังบันทึก...":"บันทึกกำหนดการ"})]})]})})}},4029:(e,t,r)=>{"use strict";r.d(t,{Z:()=>y});var s=r(326),a=r(7577);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),i=e=>{let t=l(e);return t.charAt(0).toUpperCase()+t.slice(1)},o=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim(),c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:n="",children:l,iconNode:i,...u},m)=>(0,a.createElement)("svg",{ref:m,...d,width:t,height:t,stroke:e,strokeWidth:s?24*Number(r)/Number(t):r,className:o("lucide",n),...!l&&!c(u)&&{"aria-hidden":"true"},...u},[...i.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(l)?l:[l]])),m=(e,t)=>{let r=(0,a.forwardRef)(({className:r,...s},l)=>(0,a.createElement)(u,{ref:l,iconNode:t,className:o(`lucide-${n(i(e))}`,`lucide-${e}`,r),...s}));return r.displayName=i(e),r},x=m("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),h=m("route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);var p=r(9837),f=r(1223);let b=e=>{let t=e?.trim();if(!t)return null;let r=/^https?:\/\//i.test(t)?t:`https://${t}`;try{let e=new URL(r);if("http:"!==e.protocol&&"https:"!==e.protocol)return null;return e.toString()}catch{return null}},g=e=>{e.stopPropagation()};function y({googleUrl:e,myMapUrl:t,className:r=""}){let a=b(e),n=b(t);if(!a&&!n)return null;let l="h-4 w-4 text-fuchsia-500",i=(0,f.cn)((0,p.$)({variant:"secondary",size:"sm"}),"w-full justify-center md:w-auto"),o=!!(a&&n),c=r?` ${r}`:"",d=(e,t,r,a)=>(0,s.jsxs)("a",{href:e,target:"_blank",rel:"noopener noreferrer",onClick:g,onPointerDownCapture:g,className:i,children:[r,s.jsx("span",{className:"whitespace-nowrap text-slate-700",children:t})]});return(0,s.jsxs)("div",{className:`${o?"grid grid-cols-2 gap-2 mt-2 md:mt-1 md:justify-items-start":"mt-2 md:mt-1"}${c}`,children:[a?d(a,"Google Map",s.jsx(x,{className:l,"aria-hidden":"true"}),!0):null,n?d(n,"My Map",s.jsx(h,{className:l,"aria-hidden":"true"}),!a):null]})}},6792:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var s=r(326),a=r(1223);let n={default:"border border-slate-200/80 bg-slate-100/70 text-slate-600",accent:"border border-fuchsia-200/70 bg-fuchsia-50 text-fuchsia-700",success:"border border-emerald-200/80 bg-emerald-50 text-emerald-700",warning:"border border-amber-200/80 bg-amber-50 text-amber-700",danger:"border border-rose-200/80 bg-rose-50 text-rose-700",neutral:"border border-slate-200/70 bg-white text-slate-700"};function l({variant:e="default",className:t,...r}){return s.jsx("span",{...r,className:(0,a.cn)("inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-semibold",n[e],t)})}},9837:(e,t,r)=>{"use strict";r.d(t,{$:()=>i,Z:()=>o});var s=r(326),a=r(1223);let n={primary:"bg-gradient-to-r from-fuchsia-500 via-purple-500 to-pink-500 text-white shadow-[0_16px_30px_rgba(236,72,153,0.25)] hover:brightness-110",secondary:"border border-slate-200/80 bg-white text-slate-700 shadow-sm hover:bg-slate-50",ghost:"text-slate-600 hover:bg-slate-100/80 hover:text-slate-900"},l={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-5 py-2.5 text-sm"};function i({variant:e="primary",size:t="md",className:r}){return(0,a.cn)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-full font-medium transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-fuchsia-300 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-60",n[e],l[t],r)}function o({className:e,variant:t,size:r,...a}){return s.jsx("button",{...a,className:i({variant:t,size:r,className:e})})}},5329:(e,t,r)=>{"use strict";r.d(t,{Ol:()=>l,SZ:()=>o,Zb:()=>n,aY:()=>c,ll:()=>i});var s=r(326),a=r(1223);function n({className:e,...t}){return s.jsx("div",{...t,className:(0,a.cn)("rounded-2xl border border-slate-200/70 bg-white shadow-sm",e)})}function l({className:e,...t}){return s.jsx("div",{...t,className:(0,a.cn)("px-5 pt-5",e)})}function i({className:e,...t}){return s.jsx("h3",{...t,className:(0,a.cn)("text-lg font-semibold tracking-tight text-slate-900",e)})}function o({className:e,...t}){return s.jsx("p",{...t,className:(0,a.cn)("text-sm text-slate-600",e)})}function c({className:e,...t}){return s.jsx("div",{...t,className:(0,a.cn)("px-5 pb-5",e)})}},9175:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var s=r(326),a=r(7577),n=r(1223);let l=(0,a.forwardRef)(({className:e,type:t,...r},a)=>s.jsx("input",{ref:a,type:t,className:(0,n.cn)("w-full rounded-xl border border-slate-200/80 bg-white px-3 py-2 text-sm text-slate-700 shadow-sm transition focus:border-fuchsia-400 focus:outline-none focus:ring-2 focus:ring-fuchsia-200",e),...r}));l.displayName="Input";let i=l},8927:(e,t,r)=>{"use strict";r.d(t,{Cq:()=>n,DQ:()=>a,Z6:()=>i,gK:()=>l,uA:()=>o});var s=r(1632);async function a(){return s.O.from("outage_jobs").select("*").order("outage_date",{ascending:!0})}async function n(e){return s.O.from("outage_jobs").insert({outage_date:e.outage_date,equipment_code:e.equipment_code,note:e.note??null})}async function l(e,t){return s.O.from("outage_jobs").update({outage_date:t.outage_date,equipment_code:t.equipment_code,note:t.note??null}).eq("id",e)}async function i(e,t){return s.O.from("outage_jobs").update({nakhon_status:"NOTIFIED",nakhon_notified_date:t.date,nakhon_memo_no:t.memoNo}).eq("id",e)}async function o(e){return s.O.from("outage_jobs").update({nakhon_status:"NOT_REQUIRED",nakhon_notified_date:null,nakhon_memo_no:null}).eq("id",e)}},1632:(e,t,r)=>{"use strict";r.d(t,{O:()=>s});let s=(0,r(9701).e)()},9701:(e,t,r)=>{"use strict";r.d(t,{X:()=>d,e:()=>c});var s=r(5157);let a="https://yhkrzepnokhiqbxwhkgz.supabase.co",n="sb_publishable_CdTtNwP3k39LxhkLkKbS3w_Y3co_tFE",l=null,i=()=>{if(!a||!n)throw Error("Missing Supabase env vars. Set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY.")},o=async(e,t)=>{},c=()=>(i(),l||(l=(0,s.eI)(a,n)),l),d=async e=>{await o(e.access_token,e.refresh_token)}},1223:(e,t,r)=>{"use strict";function s(...e){return e.filter(Boolean).join(" ")}r.d(t,{cn:()=>s})},2029:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n,metadata:()=>a});var s=r(9510);r(5023);let a={title:"Krabi Outage Tracker",description:"Track planned outages in Krabi."};function n({children:e}){return s.jsx("html",{lang:"th",children:s.jsx("body",{children:s.jsx("div",{className:"min-h-screen",children:s.jsx("main",{className:"mx-auto flex w-full max-w-5xl flex-col px-4 py-8",children:e})})})})}},5023:()=>{}};